<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>스마트 피자 주문서</title>
  <link rel="stylesheet" href="style.css">

  <style>
    #menu_box {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 5px;
      background: #fafafa;
    }

    #menu_box div {
      margin-bottom: 6px;
    }

    /* 수량 입력칸이 추가 설정 없이는 숫자가 보이지 않습니다! */
    .menu-qty {
      width: 60px;
      padding: 4px;
      font-size: 1rem;
    }
  </style>

  <script>
   
    function recalc() {
      var total = 0;
      var checks = document.getElementsByClassName("menu-check");
      var qtys = document.getElementsByClassName("menu-qty");

      for (var i = 0; i < checks.length; i++) {
        if (checks[i].checked) {
          var price = parseInt(checks[i].value);
          var quantity = parseInt(qtys[i].value);

          if (isNaN(quantity) || quantity < 1) {
            quantity = 1;
          }
          total += price * quantity;
        }
      }
      document.getElementById("total").value = total;
    }


    function checkAddress() {
      var addr = document.getElementById("addr");
      if (addr.value === "") {
        alert("배달 받으실 주소를 반드시 입력해주세요!");
        addr.focus();
      }
    }

    // 추가사항 - 주소와 값 입력의 안전성을 확보. 주소 미입력시 무한 루프를 막기 위해 html 주소입력칸과 같이 수정했습니다!
    function validate(e) {
      var addr = document.getElementById("addr").value.trim();

      var total = parseInt(document.getElementById("total").value, 10) || 0;

      if (addr === "") {
        alert("배달 받으실 주소를 입력해주세요!");
        document.getElementById("addr").focus();
        e.preventDefault();
        return false;
      }

      if (total === 0) {
        alert("상품을 적어도 하나는 선택해야 주문 가능합니다.");
        e.preventDefault();
        return false;
      }

      alert("주문이 완료되었습니다! (총 결제금액: " + total + "원)");
      e.preventDefault(); 
      return false;
    }
  </script>
</head>

<body>
  <header>
    <h1>장준수 홈페이지</h1>
    <p class="subtitle">한 줄 소개: 대학교 재학중인 장준수입니다</p>
  </header>
  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="portfolio.html">Portfolio</a>
    <a href="contact.html">Contact</a>
  </nav>

  <main class="container">
    <section>
      <h2>실습 5: 스마트 피자 주문서</h2>
      <p>이벤트(onchange, onblur, onsubmit)를 활용한 피자 주문 예제입니다.</p>
      <hr>

      <form action="#" onsubmit="return validate(event)">
        <div id="menu_box">
          <h4>[메뉴 선택]</h4>

          <div>
            <input type="checkbox" class="menu-check" value="15000" onchange="recalc()">
            콤비네이션 피자 (15,000원)
            <input type="number" class="menu-qty" value="1" min="1" style="width: 40px;" onchange="recalc()"
              onkeyup="recalc()"> 개
          </div>

          <div>
            <input type="checkbox" class="menu-check" value="12000" onchange="recalc()">
            페퍼로니 피자 (12,000원)
            <input type="number" class="menu-qty" value="1" min="1" style="width: 40px;" onchange="recalc()"
              onkeyup="recalc()"> 개
          </div>

          <div>
            <input type="checkbox" class="menu-check" value="2000" onchange="recalc()">
            치즈 토핑 추가 (2,000원)
            <input type="number" class="menu-qty" value="1" min="1" style="width: 40px;" onchange="recalc()"
              onkeyup="recalc()"> 개
          </div>

          <div>
            <input type="checkbox" class="menu-check" value="1500" onchange="recalc()">
            콜라 1.25L (1,500원)
            <input type="number" class="menu-qty" value="1" min="1" style="width: 40px;" onchange="recalc()"
              onkeyup="recalc()"> 개
          </div>
        </div>

        <label for="addr">배달 주소:</label>
        <input type="text" id="addr" size="50" placeholder="주소를 입력하세요">
        <br><br>

        주문 합계:
        <input type="text" id="total" value="0" readonly> 원
        <br><br>

        <input type="submit" value="주문하기">
        <input type="reset" value="초기화" onclick="setTimeout(recalc, 0)">
      </form>
    </section>
  </main>


  <footer>
    <small>&copy; <span id="year"></span> 장준수</small>
  </footer>


  <script src="script.js"></script>
</body>

</html>